
import 'package:connect2bahmni/domain/models/bahmni_drug_order.dart';
import 'package:flutter_test/flutter_test.dart';

void main() {
  test('Should deserialize drug orders', () {
    var bahmniDrugOrders = [{"visit":{"uuid":"01b30064-f029-4318-ab94-a0184b2c693a","startDateTime":1690713774000},"drugOrder":{"concept":{"uuid":"77897AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA","name":"Ibuprofen","dataType":"N/A","shortName":"Ibuprofen","units":null,"conceptClass":"Drug","hiNormal":null,"lowNormal":null,"set":false,"mappings":[{"code":"5640","name":null,"source":"RxNORM"},{"code":"77897","name":null,"source":"CIEL"},{"code":"475","name":null,"source":"AMPATH"},{"code":"912","name":null,"source":"AMPATH"},{"code":"234","name":null,"source":"AMPATH"},{"code":"38268001","name":null,"source":"SNOMED-CT"}]},"instructions":null,"uuid":"23ff2a29-e2c7-46d5-8297-d410160daa9c","orderType":"Drug Order","orderGroup":null,"dateCreated":null,"dateChanged":null,"dateStopped":null,"orderNumber":"ORD-51","careSetting":"OUTPATIENT","action":"NEW","commentToFulfiller":null,"autoExpireDate":1690985271000,"urgency":null,"previousOrderUuid":null,"drug":{"name":"Ibuprofen 400 mg","uuid":"9c7360b0-5c92-4cd5-b831-d6a76b09ae79","form":"Tablet","strength":"400 mg"},"drugNonCoded":null,"dosingInstructionType":"org.openmrs.module.bahmniemrapi.drugorder.dosinginstructions.FlexibleDosingInstructions","dosingInstructions":{"dose":1.0,"doseUnits":"Tablet","route":"Oral","frequency":"Thrice a day","asNeeded":false,"administrationInstructions":"{\"instructions\":\"As directed\"}","quantity":9.0,"quantityUnits":"Tablet","numberOfRefills":null},"dateActivated":1690726072000,"scheduledDate":1690726072000,"effectiveStartDate":1690726072000,"effectiveStopDate":1690985271000,"orderReasonText":null,"duration":3,"durationUnits":"Days","voided":false,"voidReason":null,"orderReasonConcept":null,"sortWeight":null,"conceptUuid":"77897AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},"provider":{"uuid":"ac370e10-0e3e-11ee-9960-0242ac150002","name":"Super Man","encounterRoleUuid":null},"orderAttributes":null,"retired":false,"encounterUuid":"6ff97b52-bfb8-4257-aba9-2161aecf99fd","creatorName":"Super Man","orderReasonConcept":null,"orderReasonText":null,"dosingInstructionType":"org.openmrs.module.bahmniemrapi.drugorder.dosinginstructions.FlexibleDosingInstructions","previousOrderUuid":null,"concept":{"uuid":"77897AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA","name":"Ibuprofen","dataType":"N/A","shortName":"Ibuprofen","units":null,"conceptClass":"Drug","hiNormal":null,"lowNormal":null,"set":false,"mappings":[{"code":"5640","name":null,"source":"RxNORM"},{"code":"77897","name":null,"source":"CIEL"},{"code":"475","name":null,"source":"AMPATH"},{"code":"912","name":null,"source":"AMPATH"},{"code":"234","name":null,"source":"AMPATH"},{"code":"38268001","name":null,"source":"SNOMED-CT"}]},"uuid":"23ff2a29-e2c7-46d5-8297-d410160daa9c","careSetting":"OUTPATIENT","orderGroup":null,"orderType":"Drug Order","drug":{"name":"Ibuprofen 400 mg","uuid":"9c7360b0-5c92-4cd5-b831-d6a76b09ae79","form":"Tablet","strength":"400 mg"},"dosingInstructions":{"dose":1.0,"doseUnits":"Tablet","route":"Oral","frequency":"Thrice a day","asNeeded":false,"administrationInstructions":"{\"instructions\":\"As directed\"}","quantity":9.0,"quantityUnits":"Tablet","numberOfRefills":null},"durationUnits":"Days","drugNonCoded":null,"autoExpireDate":1690985271000,"scheduledDate":1690726072000,"dateStopped":null,"instructions":null,"dateActivated":1690726072000,"commentToFulfiller":null,"orderNumber":"ORD-51","effectiveStartDate":1690726072000,"effectiveStopDate":1690985271000,"sortWeight":null,"duration":3,"action":"NEW"},{"visit":{"uuid":"01b30064-f029-4318-ab94-a0184b2c693a","startDateTime":1690713774000},"drugOrder":{"concept":{"uuid":"78467AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA","name":"Ketamine","dataType":"N/A","shortName":"Ketamine","units":null,"conceptClass":"Drug","hiNormal":null,"lowNormal":null,"set":false,"mappings":[{"code":"6130","name":null,"source":"RxNORM"},{"code":"333847008","name":null,"source":"SNOMED-CT"},{"code":"78467","name":null,"source":"CIEL"},{"code":"373464007","name":null,"source":"SNOMED-CT"}]},"instructions":null,"uuid":"e1cbbb87-9837-4332-8b7d-e404fcf58519","orderType":"Drug Order","orderGroup":null,"dateCreated":null,"dateChanged":null,"dateStopped":null,"orderNumber":"ORD-50","careSetting":"OUTPATIENT","action":"NEW","commentToFulfiller":null,"autoExpireDate":1693133354000,"urgency":null,"previousOrderUuid":null,"drug":{"name":"Ketamine 10 mg/ml","uuid":"f6d7a006-ad6b-41ca-aa4f-0bb0ddf75f32","form":"Injection","strength":"10 mg/ml"},"drugNonCoded":null,"dosingInstructionType":"org.openmrs.module.bahmniemrapi.drugorder.dosinginstructions.FlexibleDosingInstructions","dosingInstructions":{"dose":1.0,"doseUnits":"Unit(s)","route":"Intravenous","frequency":"Once a week","asNeeded":false,"administrationInstructions":"{\"instructions\":\"As directed\"}","quantity":4.0,"quantityUnits":"Unit(s)","numberOfRefills":null},"dateActivated":1690714155000,"scheduledDate":1690714155000,"effectiveStartDate":1690714155000,"effectiveStopDate":1693133354000,"orderReasonText":null,"duration":4,"durationUnits":"Weeks","voided":false,"voidReason":null,"orderReasonConcept":null,"sortWeight":null,"conceptUuid":"78467AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},"provider":{"uuid":"ac370e10-0e3e-11ee-9960-0242ac150002","name":"Super Man","encounterRoleUuid":null},"orderAttributes":null,"retired":false,"encounterUuid":"7b6087ce-4cc8-4ed3-af2d-8270986ec968","creatorName":"Super Man","orderReasonConcept":null,"orderReasonText":null,"dosingInstructionType":"org.openmrs.module.bahmniemrapi.drugorder.dosinginstructions.FlexibleDosingInstructions","previousOrderUuid":null,"concept":{"uuid":"78467AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA","name":"Ketamine","dataType":"N/A","shortName":"Ketamine","units":null,"conceptClass":"Drug","hiNormal":null,"lowNormal":null,"set":false,"mappings":[{"code":"6130","name":null,"source":"RxNORM"},{"code":"333847008","name":null,"source":"SNOMED-CT"},{"code":"78467","name":null,"source":"CIEL"},{"code":"373464007","name":null,"source":"SNOMED-CT"}]},"uuid":"e1cbbb87-9837-4332-8b7d-e404fcf58519","careSetting":"OUTPATIENT","orderGroup":null,"orderType":"Drug Order","drug":{"name":"Ketamine 10 mg/ml","uuid":"f6d7a006-ad6b-41ca-aa4f-0bb0ddf75f32","form":"Injection","strength":"10 mg/ml"},"dosingInstructions":{"dose":1.0,"doseUnits":"Unit(s)","route":"Intravenous","frequency":"Once a week","asNeeded":false,"administrationInstructions":"{\"instructions\":\"As directed\"}","quantity":4.0,"quantityUnits":"Unit(s)","numberOfRefills":null},"durationUnits":"Weeks","drugNonCoded":null,"autoExpireDate":1693133354000,"scheduledDate":1690714155000,"dateStopped":null,"instructions":null,"dateActivated":1690714155000,"commentToFulfiller":null,"orderNumber":"ORD-50","effectiveStartDate":1690714155000,"effectiveStopDate":1693133354000,"sortWeight":null,"duration":4,"action":"NEW"},{"visit":{"uuid":"01b30064-f029-4318-ab94-a0184b2c693a","startDateTime":1690713774000},"drugOrder":{"concept":{"uuid":"70116AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA","name":"Acetaminophen","dataType":"N/A","shortName":"Acetaminophen","units":null,"conceptClass":"Drug","hiNormal":null,"lowNormal":null,"set":false,"mappings":[{"code":"453","name":null,"source":"AMPATH"},{"code":"70116","name":null,"source":"CIEL"},{"code":"89","name":null,"source":"AMPATH"},{"code":"161","name":null,"source":"RxNORM"},{"code":"90332006","name":null,"source":"SNOMED-CT"}]},"instructions":null,"uuid":"e8fa0e05-d3ba-458f-bd59-439764287e73","orderType":"Drug Order","orderGroup":null,"dateCreated":null,"dateChanged":null,"dateStopped":null,"orderNumber":"ORD-49","careSetting":"OUTPATIENT","action":"NEW","commentToFulfiller":null,"autoExpireDate":1690886663000,"urgency":null,"previousOrderUuid":null,"drug":{"name":"Paracetamol 500 mg","uuid":"f085d724-a83b-4834-ad2e-81a16fad3ad6","form":"Tablet","strength":"500 mg"},"drugNonCoded":null,"dosingInstructionType":"org.openmrs.module.bahmniemrapi.drugorder.dosinginstructions.FlexibleDosingInstructions","dosingInstructions":{"dose":null,"doseUnits":"Tablet","route":"Oral","frequency":null,"asNeeded":false,"administrationInstructions":"{\"instructions\":\"As directed\",\"morningDose\":1,\"afternoonDose\":0,\"eveningDose\":1}","quantity":4.0,"quantityUnits":"Tablet","numberOfRefills":null},"dateActivated":1690713864000,"scheduledDate":1690713864000,"effectiveStartDate":1690713864000,"effectiveStopDate":1690886663000,"orderReasonText":null,"duration":2,"durationUnits":"Days","voided":false,"voidReason":null,"orderReasonConcept":null,"sortWeight":null,"conceptUuid":"70116AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},"provider":{"uuid":"ac370e10-0e3e-11ee-9960-0242ac150002","name":"Super Man","encounterRoleUuid":null},"orderAttributes":null,"retired":false,"encounterUuid":"7b6087ce-4cc8-4ed3-af2d-8270986ec968","creatorName":"Super Man","orderReasonConcept":null,"orderReasonText":null,"dosingInstructionType":"org.openmrs.module.bahmniemrapi.drugorder.dosinginstructions.FlexibleDosingInstructions","previousOrderUuid":null,"concept":{"uuid":"70116AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA","name":"Acetaminophen","dataType":"N/A","shortName":"Acetaminophen","units":null,"conceptClass":"Drug","hiNormal":null,"lowNormal":null,"set":false,"mappings":[{"code":"453","name":null,"source":"AMPATH"},{"code":"70116","name":null,"source":"CIEL"},{"code":"89","name":null,"source":"AMPATH"},{"code":"161","name":null,"source":"RxNORM"},{"code":"90332006","name":null,"source":"SNOMED-CT"}]},"uuid":"e8fa0e05-d3ba-458f-bd59-439764287e73","careSetting":"OUTPATIENT","orderGroup":null,"orderType":"Drug Order","drug":{"name":"Paracetamol 500 mg","uuid":"f085d724-a83b-4834-ad2e-81a16fad3ad6","form":"Tablet","strength":"500 mg"},"dosingInstructions":{"dose":null,"doseUnits":"Tablet","route":"Oral","frequency":null,"asNeeded":false,"administrationInstructions":"{\"instructions\":\"As directed\",\"morningDose\":1,\"afternoonDose\":0,\"eveningDose\":1}","quantity":4.0,"quantityUnits":"Tablet","numberOfRefills":null},"durationUnits":"Days","drugNonCoded":null,"autoExpireDate":1690886663000,"scheduledDate":1690713864000,"dateStopped":null,"instructions":null,"dateActivated":1690713864000,"commentToFulfiller":null,"orderNumber":"ORD-49","effectiveStartDate":1690713864000,"effectiveStopDate":1690886663000,"sortWeight":null,"duration":2,"action":"NEW"}];
    var medList = bahmniDrugOrders.map((e) => BahmniDrugOrder.fromJson(e)).toList();
    expect(medList.length, 3);
    expect(medList[0].drug?.name, 'Ibuprofen 400 mg');
    expect(medList[0].dosingInstructions?.dose, 1.0);
    expect(medList[0].dosingInstructions?.frequency, 'Thrice a day');
  });
}